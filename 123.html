<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>경마 게임</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        #raceTrack {
            width: 650px;
            height: 460px;
            border: 2px solid black;
            position: relative;
            margin-top: 20px;
            background-image: url('image.png'); /* 배경 이미지 */
            background-size: cover; /* 배경 이미지 크기 조정 */
            background-position: center;
        }

        /* 각 말들이 달리는 경로 하단에 가로 라인 그리기 */
        .trackLine {
            position: absolute;
            width: 100%;
            height: 4px; /* 두꺼운 라인 */
            background-color: #333;
            z-index: 2; /* 다른 요소들보다 위로 설정 */
        }


        /* 말 스타일 */
        .horse {
            position: absolute;
            width: 60px;
            height: 60px;
            transition: left 0.1s linear;
            z-index: 3; /* 말들이 가로 라인 위에 오도록 설정 */
        }

        .horse:nth-child(1) { top: 0px; }
        .horse:nth-child(2) { top: 50px; }
        .horse:nth-child(3) { top: 100px; }
        .horse:nth-child(4) { top: 150px; }
        .horse:nth-child(5) { top: 200px; }
        .horse:nth-child(6) { top: 250px; }
        .horse:nth-child(7) { top: 300px; }
        .horse:nth-child(8) { top: 350px; }
        .horse:nth-child(9) { top: 400px; }

        /* 결승점 스타일 */
        .finishLine {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: grey;
            right: 0;
        }

        .finishLine.winner {
            background-color: gold; /* 1등 말의 결승점 색 */
        }

        #startButton {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
        #winner {
            font-size: 20px;
            margin-top: 20px;
            font-weight: bold;
        }

        /* 승리 이미지 팝업 스타일 */
        #popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 30px;
            border: 2px solid black;
            text-align: center;
            z-index: 10;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            width: 400px;
        }
        #popup img {
            width: 150px;
            height: 150px;
        }
        #popup button {
            margin-top: 10px;
            padding: 10px 20px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
        }
        #popup button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>

    <h1>경마 게임</h1>
    <div id="raceTrack">
        <!-- 9마리 말의 이미지 넣기 -->
        <img id="horse1" class="horse" src="1-1.png" alt="Horse 1">
        <img id="horse2" class="horse" src="2-1.png" alt="Horse 2">
        <img id="horse3" class="horse" src="3-1.png" alt="Horse 3">
        <img id="horse4" class="horse" src="4-1.png" alt="Horse 4">
        <img id="horse5" class="horse" src="5-1.png" alt="Horse 5">
        <img id="horse6" class="horse" src="6-1.png" alt="Horse 6">
        <img id="horse7" class="horse" src="7-1.png" alt="Horse 7">
        <img id="horse8" class="horse" src="8-1.png" alt="Horse 8">
        <img id="horse9" class="horse" src="9-1.png" alt="Horse 9">

        <!-- 결승점 추가 -->
        <div class="finishLine" id="finish1" style="top: 40px;"></div>
        <div class="finishLine" id="finish2" style="top: 90px;"></div>
        <div class="finishLine" id="finish3" style="top: 140px;"></div>
        <div class="finishLine" id="finish4" style="top: 190px;"></div>
        <div class="finishLine" id="finish5" style="top: 240px;"></div>
        <div class="finishLine" id="finish6" style="top: 290px;"></div>
        <div class="finishLine" id="finish7" style="top: 340px;"></div>
        <div class="finishLine" id="finish8" style="top: 390px;"></div>
        <div class="finishLine" id="finish9" style="top: 440px;"></div>

        <!-- 경마장 가로 라인 (8개) -->
        <div class="trackLine" style="top: 60px;"></div>
        <div class="trackLine" style="top: 110px;"></div>
        <div class="trackLine" style="top: 160px;"></div>
        <div class="trackLine" style="top: 210px;"></div>
        <div class="trackLine" style="top: 260px;"></div>
        <div class="trackLine" style="top: 310px;"></div>
        <div class="trackLine" style="top: 360px;"></div>
        <div class="trackLine" style="top: 410px;"></div>
        <div class="trackLine" style="top: 460px;"></div>
    </div>

    <button id="startButton">게임 시작</button>
    <div id="winner"></div>

    <!-- 팝업 창 -->
    <div id="popup">
        <h2>축하합니다!</h2>
        <img id="winningHorseImage" src="" alt="Winning Horse">
        <p id="congratulationsMessage"></p>
        <button onclick="closePopup()">닫기</button>
    </div>

    <script>
        document.getElementById("startButton").addEventListener("click", startRace);

        function startRace() {
            let horses = [];
            let firstHorseToFinish = null;  // 첫 번째로 결승선에 도달한 말을 추적

            // 경주 시작 전, 말들을 원래 이미지로 초기화
            for (let i = 1; i <= 9; i++) {
                horses.push({
                    id: "horse" + i,
                    position: 0,
                    hasFinished: false,
                    originalImage: `${i}-1.png` // 원래 이미지 경로 설정
                });
                // 각 말의 이미지를 원래 상태로 되돌려 놓기
                document.getElementById("horse" + i).src = horses[i - 1].originalImage;
            }

            // 결승점 색 초기화
            for (let i = 1; i <= 9; i++) {
                document.getElementById("finish" + i).style.backgroundColor = 'grey'; // 회색으로 초기화
            }

            const trackLength = 600;
            let raceInterval;
            let winner = null;

            document.getElementById("startButton").disabled = true;
            document.getElementById("winner").innerText = "";

            // 각 말에 대한 도착 이미지와 승리 이미지 설정
            const finishImages = {
                horse1: "1-2.png",
                horse2: "2-2.png",
                horse3: "3-2.png",
                horse4: "4-2.png",
                horse5: "5-2.png",
                horse6: "6-2.png",
                horse7: "7-2.png",
                horse8: "8-2.png",
                horse9: "9-2.png"
            };
            const winnerImages = {
                horse1: "1-3.png",
                horse2: "2-3.png",
                horse3: "3-3.png",
                horse4: "4-3.png",
                horse5: "5-3.png",
                horse6: "6-3.png",
                horse7: "7-3.png",
                horse8: "8-3.png",
                horse9: "9-3.png"
            };

            raceInterval = setInterval(function () {
                let allFinished = true;

                horses.forEach(function (horse) {
                    if (!horse.hasFinished) {
                        horse.position += Math.random() * 10;

                        let horseElement = document.getElementById(horse.id);
                        horseElement.style.left = horse.position + "px";

                        if (horse.position >= trackLength && !horse.hasFinished) {
                            horse.hasFinished = true;
                            horseElement.src = finishImages[horse.id];

                            if (!firstHorseToFinish) {
                                firstHorseToFinish = horse.id; // 첫 번째로 도달한 말 설정
                                document.getElementById("finish" + (horses.indexOf(horse) + 1)).style.backgroundColor = 'gold'; // 결승점 색 gold로 변경
                            }
                        }
                    }

                    if (!horse.hasFinished) {
                        allFinished = false;
                    }
                });

                if (allFinished && !winner) {
                    winner = firstHorseToFinish;
                    clearInterval(raceInterval);
                    document.getElementById("winner").innerText = `${winner}가 승리했습니다!`;

                    // 승리한 말의 이미지 띄우기
                    let winnerHorseImage = document.getElementById("winningHorseImage");
                    winnerHorseImage.src = winnerImages[winner]; // 승리한 말 이미지로 변경
                    document.getElementById("congratulationsMessage").innerText = `${winner}가 승리했습니다!`;

                    document.getElementById("popup").style.display = "block";
                }
            }, 50);
        }

        function closePopup() {
            document.getElementById("popup").style.display = "none";
            document.getElementById("startButton").disabled = false;
        }
    </script>
</body>
</html>
